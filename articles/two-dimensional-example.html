<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Two-Dimensional Examples of catsim • catsim</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Two-Dimensional Examples of catsim">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">catsim</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9034</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/two-dimensional-example.html">Two-Dimensional Examples of catsim</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/gzt/catsim">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Two-Dimensional Examples of catsim</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/gzt/catsim/blob/master/vignettes/two-dimensional-example.Rmd"><code>vignettes/two-dimensional-example.Rmd</code></a></small>
      <div class="hidden name"><code>two-dimensional-example.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(catsim)</a></code></pre></div>
<div id="introduction-to-catsim" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction-to-catsim" class="anchor"></a>Introduction to <code>catsim</code>
</h1>
<p>The <strong>Cat</strong>egorial <strong>S</strong>tructural Similarity <strong>I</strong>mage <strong>M</strong>etric, or <strong>CatSIM</strong>, provides a similarity metric for binary or multicategory images or maps after the style of <a href="https://en.wikipedia.org/wiki/Structural_similarity">MS-SSIM</a>. It attempts to assess similiarity between two images that accounts for the similiarity between structures or regions of the image rather than a per-pixel discrepancy, ideally in a way which is similar to human assessments of similarity.</p>
<p>It works by assessing similarity within a a sliding window across the image, then downsampling and doing the same on different scales, and then combining the ratings together.</p>
</div>
<div id="constructing-an-example" class="section level1">
<h1 class="hasAnchor">
<a href="#constructing-an-example" class="anchor"></a>Constructing an example</h1>
<p>To demonstrate how it works, first we construct a simple multicategory image and blow it up to a larger size. The grid lines are added for reference. This is our “ground truth” image.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"> multfactor =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"> onesmat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">1</span>,multfactor,multfactor)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"> exmat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dv">0</span>,<span class="dv">12</span>,<span class="dv">12</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5"> exmat[<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">9</span>,<span class="dv">10</span>)] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"> exmat[<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>)] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"> exmat[<span class="dv">5</span><span class="op">:</span><span class="dv">7</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"> exmat[<span class="dv">2</span><span class="op">:</span><span class="dv">10</span>,<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">6</span>)] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"> <span class="kw"><a href="https://rdrr.io/r/graphics/image.html">image</a></span>(exmat[<span class="dv">11</span><span class="op">:</span><span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">11</span>])</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">  <span class="kw"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span>(<span class="dt">col=</span><span class="st">"black"</span>)</a></code></pre></div>
<p><img src="two-dimensional-example_files/figure-html/construction-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"> bigmat =<span class="st"> </span>exmat <span class="op">%x%</span><span class="st"> </span>onesmat</a></code></pre></div>
<p>Next, we construct two distorted versions. The first simply shifts the central portion of the image over six pixels. Then, we compute the percentage of pixels that disagree with the baseline image and create a second distorted image by adding salt-and-pepper noise at that rate. Again, grid lines are added only for reference.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"> <span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">20200323</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"> shift=<span class="dv">6</span> <span class="co"># we are shifting horizontally by six pixels</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"> basemat &lt;-<span class="st"> </span>bigmat[<span class="dv">1</span><span class="op">:</span>(<span class="dv">11</span><span class="op">*</span>multfactor),<span class="dv">1</span><span class="op">:</span>(<span class="dv">11</span><span class="op">*</span>multfactor)]</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"> shiftmat &lt;-<span class="st"> </span>bigmat[(<span class="dv">1</span><span class="op">+</span>shift)<span class="op">:</span>(<span class="dv">11</span><span class="op">*</span>multfactor<span class="op">+</span>shift),<span class="dv">1</span><span class="op">:</span>(<span class="dv">11</span><span class="op">*</span>multfactor)]</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"> ### Here we have shifted the matrix slightly</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"> <span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"> <span class="kw"><a href="https://rdrr.io/r/graphics/image.html">image</a></span>(shiftmat)</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"> <span class="kw"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span>(<span class="dt">col=</span><span class="st">"black"</span>)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9"></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"> ### computing the error rate</a>
<a class="sourceLine" id="cb4-11" data-line-number="11"> acc =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(basemat<span class="op">==</span>shiftmat)</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"> errmat &lt;-<span class="st"> </span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">0</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">121</span><span class="op">*</span>(multfactor<span class="op">^</span><span class="dv">2</span>),<span class="dt">replace=</span><span class="ot">TRUE</span>,<span class="dt">prob=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(acc,<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>((<span class="dv">1</span><span class="op">-</span>acc)<span class="op">/</span><span class="dv">3</span>,<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb4-13" data-line-number="13">    (<span class="dv">11</span><span class="op">*</span>multfactor),(<span class="dv">11</span><span class="op">*</span>multfactor))<span class="op">+</span>basemat) <span class="op">%%</span><span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"> ### here we have made an image that matches its accuracy with salt and pepper noise</a>
<a class="sourceLine" id="cb4-16" data-line-number="16"> <span class="kw"><a href="https://rdrr.io/r/graphics/image.html">image</a></span>(errmat)</a>
<a class="sourceLine" id="cb4-17" data-line-number="17"> <span class="kw"><a href="https://rdrr.io/r/graphics/grid.html">grid</a></span>(<span class="dt">col=</span><span class="st">"black"</span>)</a></code></pre></div>
<p><img src="two-dimensional-example_files/figure-html/distortion-1.png" width="700"></p>
<p>Depending on your preferences, you may have reason to prefer one or the other, but, arguably, the shifted version is in some sense better, even though their pixelwise agreement is approximately the same.</p>
</div>
<div id="computing-image-similarity" class="section level1">
<h1 class="hasAnchor">
<a href="#computing-image-similarity" class="anchor"></a>Computing Image Similarity</h1>
<p>If we take only one level of <code>catsim</code>, we get the following results when comparing to the initial matrix:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(catsim)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">### comparing base to shifted</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat,shiftmat,<span class="dt">weights=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; [1] 0.7671958</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"></a>
<a class="sourceLine" id="cb5-6" data-line-number="6">### comparing base to salt-and-pepper</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat,errmat,<span class="dt">weights=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; [1] 0.1004043</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">### looking at accuracy</a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(basemat <span class="op">==</span><span class="st"> </span>shiftmat)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; [1] 0.9355372</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(basemat <span class="op">==</span><span class="st"> </span>errmat)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; [1] 0.9364463</span></a></code></pre></div>
<p>This captures the similarity between the original image and the shifted image, but is too “critical” of the salt-and-pepper error. We can correct this by looking at the image on multiple scales: we downsample by a factor of 2 and then compute the index for that layer, then repeat, and combine the layers at the end into one measure. By default, we use 5 layers of downsampling, but this can be specified based on your application and the size of the image. Downsampling should remove and smooth out a light level of salt-and-pepper error.</p>
<p>With five levels, the difference is smaller, but still prefers the shifted version over the salt and pepper error.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat,shiftmat,<span class="dt">weights=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(.<span class="dv">2</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; [1] 0.8124715</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">### comparing base to salt-and-pepper</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat,errmat,<span class="dt">weights=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(.<span class="dv">2</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; [1] 0.6088753</span></a></code></pre></div>
</div>
<div id="catsim-options" class="section level1">
<h1 class="hasAnchor">
<a href="#catsim-options" class="anchor"></a>CatSIM options</h1>
<p>By default, CatSIM uses <a href="https://en.wikipedia.org/wiki/Cohen's_kappa">Cohen’s kappa (<span class="math inline">\(\kappa\)</span>)</a> as the similarity comparison for the images. This measures agreement between the classes with and adjustment for the probability of chance agreement. However, depending on the application, a different comparison might make sense. The following options are availabe (using the <code>method</code> argument):</p>
<ul>
<li>
<a href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard index</a>, suitable for binary images where presence of one class is important (for instance, fMRI activation maps), with <code>method="Jaccard"</code>.</li>
<li>
<a href="">Dice index</a>, which is similar to the Jaccard index, with <code>method="Dice"</code>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Rand_index">Rand index</a>, a similarity metric for comparing clusterings based on whether pairs of points are in the same group, with <code>method="Rand"</code>.</li>
<li>
<a href="https://en.wikipedia.org/wiki/Rand_index#Adjusted_Rand_index">Adjusted Rand index</a>, a modification of the Rand index which corrects for the probability of chance agreements, with <code>method ="AdjRand"</code> or <code>ARI</code>.</li>
<li>Accuracy, or pixel-wise agreement, which is simply <code>(# pixels agreeing)/(# pixels)</code>, with <code>method="accuracy"</code>.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat,shiftmat,<span class="dt">weights=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(.<span class="dv">2</span>,<span class="dv">5</span>), <span class="dt">method=</span><span class="st">"Rand"</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; [1] 0.8717583</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat,shiftmat,<span class="dt">weights=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(.<span class="dv">2</span>,<span class="dv">5</span>), <span class="dt">method=</span><span class="st">"AdjRand"</span>)</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt; [1] 0.7932343</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat,shiftmat,<span class="dt">weights=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(.<span class="dv">2</span>,<span class="dv">5</span>), <span class="dt">method=</span><span class="st">"accuracy"</span>)</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; [1] 0.8771697</span></a></code></pre></div>
<p>The window size can also be adjusted. It should be large enough to capture the scale of the features that are relevant in the analysis. In this example, a portion of the image was displaced by 6 pixels. Too large of a window may average out that difference too much while too small may miss the similarity between the images. Here is a comparison between the shifted image and the salt-and-pepper noise at different window sizes.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat, shiftmat,<span class="dt">weights=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(.<span class="dv">2</span>,<span class="dv">5</span>), <span class="dt">window =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; Warning in catmssim_2d(x, y, weights = weights, method = method, window =</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; window, : Truncating levels because of minimum dimension.</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; [1] 0.8614266</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat, shiftmat,<span class="dt">weights=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(.<span class="dv">2</span>,<span class="dv">5</span>), <span class="dt">window =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; [1] 0.8124715</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat, errmat,<span class="dt">weights=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(.<span class="dv">2</span>,<span class="dv">5</span>), <span class="dt">window =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; Warning in catmssim_2d(x, y, weights = weights, method = method, window =</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt; window, : Truncating levels because of minimum dimension.</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; [1] 0.7913071</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat, errmat,<span class="dt">weights=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(.<span class="dv">2</span>,<span class="dv">5</span>), <span class="dt">window =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; [1] 0.6088753</span></a></code></pre></div>
<div id="advanced-functionality" class="section level2">
<h2 class="hasAnchor">
<a href="#advanced-functionality" class="anchor"></a>Advanced Functionality</h2>
<p>The <code><a href="../reference/catsim.html">catsim()</a></code> function works for both 2-D and 3-D images. It is a wrapper for other functions which give more control over the various options. On a 2-D image, it is calling <code><a href="../reference/catmssim_2d.html">catmssim_2d()</a></code> and on a 3-D image it is calling either <code><a href="../reference/catmssim_3d_cube.html">catmssim_3d_cube()</a></code> or <code><a href="../reference/catmssim_3d_slice.html">catmssim_3d_slice()</a></code>, which treats the image as either an isotropic 3-D image or a stack of 2-D slices.</p>
<p>In images with different properties across dimensions, the sliding window used to assess the similarity might not need to be square. This can be specified by passing a vector to the <code>window</code> argument. In the provided examples, this is not necessary, but some sources of images may not be isotropic. Alternatively, the image may be elongated in one direction and narrow in another. This makes it possible to accommodate these differences.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/catsim.html">catsim</a></span>(basemat,shiftmat,<span class="dt">weights=</span><span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(.<span class="dv">2</span>,<span class="dv">5</span>), <span class="dt">window=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">11</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; [1] 0.7994898</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction-to-catsim">Introduction to <code>catsim</code></a></li>
      <li><a href="#constructing-an-example">Constructing an example</a></li>
      <li><a href="#computing-image-similarity">Computing Image Similarity</a></li>
      <li>
<a href="#catsim-options">CatSIM options</a><ul class="nav nav-pills nav-stacked">
<li><a href="#advanced-functionality">Advanced Functionality</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Geoffrey Thompson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
